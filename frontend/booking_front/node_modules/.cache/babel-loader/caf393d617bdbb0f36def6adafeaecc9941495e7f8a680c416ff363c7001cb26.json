{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Box,Dialog,DialogTitle,DialogContent,Typography,Grid,Card,CardContent,CardMedia,Button,TextField,DialogActions,Alert,useTheme,useMediaQuery,Paper,Tabs,Tab,IconButton,Tooltip}from'@mui/material';import{DateCalendar}from'@mui/x-date-pickers/DateCalendar';import{LocalizationProvider}from'@mui/x-date-pickers/LocalizationProvider';import{AdapterDateFns}from'@mui/x-date-pickers/AdapterDateFns';import{format,addHours,parseISO}from'date-fns';import{ru}from'date-fns/locale';import axios from'axios';import{useAuth}from'../contexts/AuthContext';import DeleteIcon from'@mui/icons-material/Delete';import{API_BASE_URL}from'../config';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Calendar=()=>{const{token}=useAuth();const theme=useTheme();const isMobile=useMediaQuery(theme.breakpoints.down('sm'));const[selectedDate,setSelectedDate]=useState(new Date());const[spaces,setSpaces]=useState([]);const[selectedSpace,setSelectedSpace]=useState(null);const[bookings,setBookings]=useState([]);const[myBookings,setMyBookings]=useState([]);const[openSpacesDialog,setOpenSpacesDialog]=useState(false);const[openBookingDialog,setOpenBookingDialog]=useState(false);const[startTime,setStartTime]=useState('00:00');const[duration,setDuration]=useState(1);const[description,setDescription]=useState('');const[error,setError]=useState('');const[activeTab,setActiveTab]=useState(0);useEffect(()=>{fetchSpaces();fetchMyBookings();},[]);const fetchSpaces=async()=>{try{const response=await axios.get(`${API_BASE_URL}/api/spaces/`,{headers:{'Authorization':`Token ${token}`}});setSpaces(response.data);}catch(err){console.error('Error fetching spaces:',err);setError('Ошибка при загрузке пространств');}};const fetchMyBookings=async()=>{try{const response=await axios.get(`${API_BASE_URL}/api/bookings/my/`,{headers:{'Authorization':`Token ${token}`}});console.log('My bookings response:',response.data);setMyBookings(response.data);}catch(err){console.error('Error fetching my bookings:',err);setError('Ошибка при загрузке ваших броней');}};const getSpaceById=spaceId=>{return spaces.find(space=>space.id===spaceId);};const calculateEndTime=(startTime,duration)=>{return format(addHours(parseISO(startTime),duration/60),\"yyyy-MM-dd'T'HH:mm:ssXXX\");};const handleDeleteBooking=async bookingId=>{try{await axios.delete(`${API_BASE_URL}/api/bookings/${bookingId}/`,{headers:{'Authorization':`Token ${token}`}});setMyBookings(myBookings.filter(booking=>booking.id!==bookingId));if(selectedSpace){const dateStr=format(selectedDate,'yyyy-MM-dd');const response=await axios.get(`${API_BASE_URL}/api/spaces/${selectedSpace.id}/bookings/?date=${dateStr}`,{headers:{'Authorization':`Token ${token}`}});setBookings(response.data);}}catch(err){console.error('Error deleting booking:',err);setError('Ошибка при удалении брони');}};const handleDateSelect=async date=>{if(!date)return;setSelectedDate(date);setOpenSpacesDialog(true);try{const response=await axios.get(`${API_BASE_URL}/api/spaces/`,{headers:{'Authorization':`Token ${token}`}});setSpaces(response.data);}catch(err){console.error('Error fetching spaces:',err);setError('Ошибка при загрузке пространств');}};const handleSpaceSelect=async space=>{setSelectedSpace(space);setOpenSpacesDialog(false);setOpenBookingDialog(true);try{const dateStr=format(selectedDate,'yyyy-MM-dd');const response=await axios.get(`${API_BASE_URL}/api/spaces/${space.id}/bookings/?date=${dateStr}`,{headers:{'Authorization':`Token ${token}`}});setBookings(response.data);}catch(err){console.error('Error fetching bookings:',err);setError('Ошибка при загрузке броней');}};const handleCreateBooking=async()=>{if(!selectedSpace||!selectedDate)return;try{const startDateTime=parseISO(`${format(selectedDate,'yyyy-MM-dd')}T${startTime}`);const durationMinutes=duration*60;if(startDateTime<new Date()){setError('Нельзя создать бронь в прошлом');return;}const response=await axios.post(`${API_BASE_URL}/api/bookings/`,{space:selectedSpace.id,start_time:format(startDateTime,\"yyyy-MM-dd'T'HH:mm:ssXXX\"),duration:durationMinutes,description:description||'-'},{headers:{'Authorization':`Token ${token}`,'Content-Type':'application/json'}});setBookings([...bookings,response.data]);setMyBookings([...myBookings,response.data]);setOpenBookingDialog(false);setError('');setDescription('');}catch(err){var _err$response,_err$response$data;console.error('Error creating booking:',err);if(axios.isAxiosError(err)&&(_err$response=err.response)!==null&&_err$response!==void 0&&(_err$response$data=_err$response.data)!==null&&_err$response$data!==void 0&&_err$response$data.non_field_errors){setError(err.response.data.non_field_errors[0]);}else{setError('Ошибка при создании брони');}}};const getImageUrl=imageUrl=>{if(!imageUrl)return'';if(imageUrl.startsWith('http'))return imageUrl;return`${API_BASE_URL}${imageUrl}`;};const isMyBooking=booking=>{return myBookings.some(myBooking=>myBooking.id===booking.id);};return/*#__PURE__*/_jsxs(Box,{sx:{minHeight:'100vh',width:'100%',p:{xs:1,sm:2,md:3},bgcolor:'background.default'},children:[/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:{xs:2,sm:3,md:4},height:'100%',display:'flex',flexDirection:'column'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,sx:{textAlign:'center',mb:3,color:'primary.main'},children:\"\\u041A\\u0430\\u043B\\u0435\\u043D\\u0434\\u0430\\u0440\\u044C \\u0431\\u0440\\u043E\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0439\"}),/*#__PURE__*/_jsxs(Tabs,{value:activeTab,onChange:(_,newValue)=>setActiveTab(newValue),sx:{mb:3},children:[/*#__PURE__*/_jsx(Tab,{label:\"\\u041A\\u0430\\u043B\\u0435\\u043D\\u0434\\u0430\\u0440\\u044C\"}),/*#__PURE__*/_jsx(Tab,{label:\"\\u041C\\u043E\\u0438 \\u0431\\u0440\\u043E\\u043D\\u0438\"})]}),activeTab===0?/*#__PURE__*/_jsx(LocalizationProvider,{dateAdapter:AdapterDateFns,adapterLocale:ru,children:/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',mb:3},children:/*#__PURE__*/_jsx(DateCalendar,{value:selectedDate,onChange:handleDateSelect,sx:{width:'100%',maxWidth:isMobile?'100%':600,'& .MuiPickersCalendarHeader-root':{display:'flex',alignItems:'center',justifyContent:'space-between',px:2},'& .MuiPickersDay-root':{width:isMobile?36:48,height:isMobile?36:48,fontSize:isMobile?'0.875rem':'1rem'}}})})}):/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\u041C\\u043E\\u0438 \\u0431\\u0440\\u043E\\u043D\\u0438:\"}),myBookings.length===0?/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"\\u0423 \\u0432\\u0430\\u0441 \\u043F\\u043E\\u043A\\u0430 \\u043D\\u0435\\u0442 \\u0431\\u0440\\u043E\\u043D\\u0435\\u0439\"}):/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:myBookings.map(booking=>{const space=getSpaceById(booking.space);const endTime=calculateEndTime(booking.start_time,booking.duration);return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'flex-start'},children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:(space===null||space===void 0?void 0:space.name)||'Загрузка...'}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",children:[format(parseISO(booking.start_time),'dd.MM.yyyy HH:mm'),\" -\",format(parseISO(endTime),'HH:mm')]}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:booking.description})]}),/*#__PURE__*/_jsx(IconButton,{onClick:()=>handleDeleteBooking(booking.id),color:\"error\",size:\"small\",children:/*#__PURE__*/_jsx(DeleteIcon,{})})]})})})},booking.id);})})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:openSpacesDialog,onClose:()=>setOpenSpacesDialog(false),maxWidth:\"md\",fullWidth:true,fullScreen:isMobile,children:[/*#__PURE__*/_jsx(DialogTitle,{sx:{textAlign:'center'},children:\"\\u0412\\u044B\\u0431\\u0435\\u0440\\u0438\\u0442\\u0435 \\u043F\\u0440\\u043E\\u0441\\u0442\\u0440\\u0430\\u043D\\u0441\\u0442\\u0432\\u043E\"}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsx(Grid,{container:true,spacing:2,children:spaces.map(space=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsxs(Card,{sx:{cursor:'pointer',height:'100%',display:'flex',flexDirection:'column','&:hover':{boxShadow:6,transform:'translateY(-4px)',transition:'all 0.3s ease-in-out'}},onClick:()=>handleSpaceSelect(space),children:[space.image&&/*#__PURE__*/_jsx(CardMedia,{component:\"img\",height:isMobile?160:200,image:getImageUrl(space.image),alt:space.name,sx:{objectFit:'cover'}}),/*#__PURE__*/_jsxs(CardContent,{sx:{flexGrow:1},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:space.name}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:space.description})]})]})},space.id))})})]}),/*#__PURE__*/_jsxs(Dialog,{open:openBookingDialog,onClose:()=>setOpenBookingDialog(false),maxWidth:\"md\",fullWidth:true,fullScreen:isMobile,children:[/*#__PURE__*/_jsxs(DialogTitle,{sx:{textAlign:'center'},children:[\"\\u0411\\u0440\\u043E\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u0438\\u0435 \",selectedSpace===null||selectedSpace===void 0?void 0:selectedSpace.name,\" \\u043D\\u0430 \",selectedDate&&format(selectedDate,'dd.MM.yyyy')]}),/*#__PURE__*/_jsxs(DialogContent,{children:[error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"\\u0417\\u0430\\u043D\\u044F\\u0442\\u043E\\u0435 \\u0432\\u0440\\u0435\\u043C\\u044F:\"}),bookings.length===0?/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"\\u041D\\u0430 \\u044D\\u0442\\u043E\\u0442 \\u0434\\u0435\\u043D\\u044C \\u043D\\u0435\\u0442 \\u0431\\u0440\\u043E\\u043D\\u0435\\u0439\"}):/*#__PURE__*/_jsx(Grid,{container:true,spacing:1,children:bookings.map(booking=>{const startTime=format(parseISO(booking.start_time),'HH:mm');const endTime=format(parseISO(calculateEndTime(booking.start_time,booking.duration)),'HH:mm');const isMyBookingItem=isMyBooking(booking);return/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,children:/*#__PURE__*/_jsxs(Paper,{elevation:2,sx:{p:1.5,bgcolor:isMyBookingItem?'primary.light':'error.light',color:isMyBookingItem?'primary.contrastText':'error.contrastText',textAlign:'center',borderRadius:1,position:'relative',cursor:isMyBookingItem?'pointer':'default','&:hover':isMyBookingItem?{bgcolor:'primary.main'}:{}},onClick:()=>isMyBookingItem&&handleDeleteBooking(booking.id),children:[/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",fontWeight:\"medium\",children:[startTime,\" - \",endTime]}),isMyBookingItem&&/*#__PURE__*/_jsx(Tooltip,{title:\"\\u041D\\u0430\\u0436\\u043C\\u0438\\u0442\\u0435, \\u0447\\u0442\\u043E\\u0431\\u044B \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C\",children:/*#__PURE__*/_jsx(DeleteIcon,{sx:{position:'absolute',top:4,right:4,fontSize:16}})})]})},booking.id);})})]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',flexDirection:isMobile?'column':'row',gap:2,mb:2},children:[/*#__PURE__*/_jsx(TextField,{label:\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u043D\\u0430\\u0447\\u0430\\u043B\\u0430\",type:\"time\",value:startTime,onChange:e=>setStartTime(e.target.value),InputLabelProps:{shrink:true},inputProps:{step:300},sx:{width:isMobile?'100%':'50%'}}),/*#__PURE__*/_jsx(TextField,{label:\"\\u0414\\u043B\\u0438\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E\\u0441\\u0442\\u044C (\\u0447\\u0430\\u0441\\u044B)\",type:\"number\",value:duration,onChange:e=>setDuration(Number(e.target.value)),InputProps:{inputProps:{min:1,max:24}},sx:{width:isMobile?'100%':'50%'}})]}),/*#__PURE__*/_jsx(TextField,{label:\"\\u041E\\u043F\\u0438\\u0441\\u0430\\u043D\\u0438\\u0435 (\\u043D\\u0435\\u043E\\u0431\\u044F\\u0437\\u0430\\u0442\\u0435\\u043B\\u044C\\u043D\\u043E)\",value:description,onChange:e=>setDescription(e.target.value),multiline:true,rows:2,fullWidth:true,sx:{mb:2}}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mb:2},children:[\"\\u0412\\u0440\\u0435\\u043C\\u044F \\u043E\\u043A\\u043E\\u043D\\u0447\\u0430\\u043D\\u0438\\u044F: \",selectedDate&&startTime&&format(addHours(parseISO(`${format(selectedDate,'yyyy-MM-dd')}T${startTime}`),duration),'HH:mm')]})]}),/*#__PURE__*/_jsxs(DialogActions,{sx:{p:2},children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenBookingDialog(false),variant:\"outlined\",fullWidth:isMobile,children:\"\\u041E\\u0442\\u043C\\u0435\\u043D\\u0430\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCreateBooking,variant:\"contained\",color:\"primary\",fullWidth:isMobile,children:\"\\u0417\\u0430\\u0431\\u0440\\u043E\\u043D\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\"})]})]})]});};export default Calendar;","map":{"version":3,"names":["React","useState","useEffect","Box","Dialog","DialogTitle","DialogContent","Typography","Grid","Card","CardContent","CardMedia","Button","TextField","DialogActions","Alert","useTheme","useMediaQuery","Paper","Tabs","Tab","IconButton","Tooltip","DateCalendar","LocalizationProvider","AdapterDateFns","format","addHours","parseISO","ru","axios","useAuth","DeleteIcon","API_BASE_URL","jsx","_jsx","jsxs","_jsxs","Calendar","token","theme","isMobile","breakpoints","down","selectedDate","setSelectedDate","Date","spaces","setSpaces","selectedSpace","setSelectedSpace","bookings","setBookings","myBookings","setMyBookings","openSpacesDialog","setOpenSpacesDialog","openBookingDialog","setOpenBookingDialog","startTime","setStartTime","duration","setDuration","description","setDescription","error","setError","activeTab","setActiveTab","fetchSpaces","fetchMyBookings","response","get","headers","data","err","console","log","getSpaceById","spaceId","find","space","id","calculateEndTime","handleDeleteBooking","bookingId","delete","filter","booking","dateStr","handleDateSelect","date","handleSpaceSelect","handleCreateBooking","startDateTime","durationMinutes","post","start_time","_err$response","_err$response$data","isAxiosError","non_field_errors","getImageUrl","imageUrl","startsWith","isMyBooking","some","myBooking","sx","minHeight","width","p","xs","sm","md","bgcolor","children","elevation","height","display","flexDirection","variant","gutterBottom","textAlign","mb","color","value","onChange","_","newValue","label","dateAdapter","adapterLocale","justifyContent","maxWidth","alignItems","px","fontSize","length","container","spacing","map","endTime","item","name","onClick","size","open","onClose","fullWidth","fullScreen","cursor","boxShadow","transform","transition","image","component","alt","objectFit","flexGrow","severity","isMyBookingItem","borderRadius","position","fontWeight","title","top","right","gap","type","e","target","InputLabelProps","shrink","inputProps","step","Number","InputProps","min","max","multiline","rows"],"sources":["C:/Users/DiXer/PycharmProjects/booking spaces/frontend/booking_front/src/components/Calendar.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { \r\n  Box, \r\n  Dialog, \r\n  DialogTitle, \r\n  DialogContent,\r\n  Typography,\r\n  Grid,\r\n  Card,\r\n  CardContent,\r\n  CardMedia,\r\n  Button,\r\n  TextField,\r\n  DialogActions,\r\n  Alert,\r\n  useTheme,\r\n  useMediaQuery,\r\n  Paper,\r\n  Tabs,\r\n  Tab,\r\n  IconButton,\r\n  Tooltip\r\n} from '@mui/material';\r\nimport { DateCalendar } from '@mui/x-date-pickers/DateCalendar';\r\nimport { LocalizationProvider } from '@mui/x-date-pickers/LocalizationProvider';\r\nimport { AdapterDateFns } from '@mui/x-date-pickers/AdapterDateFns';\r\nimport { format, addHours, parseISO, isSameDay } from 'date-fns';\r\nimport { ru } from 'date-fns/locale';\r\nimport axios from 'axios';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport { API_BASE_URL } from '../config';\r\n\r\ninterface Space {\r\n  id: number;\r\n  name: string;\r\n  description: string;\r\n  image: string;\r\n}\r\n\r\ninterface Booking {\r\n  id: number;\r\n  space: number;\r\n  start_time: string;\r\n  duration: number;\r\n  description: string;\r\n}\r\n\r\nconst Calendar: React.FC = () => {\r\n  const { token } = useAuth();\r\n  const theme = useTheme();\r\n  const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\r\n  const [selectedDate, setSelectedDate] = useState<Date | null>(new Date());\r\n  const [spaces, setSpaces] = useState<Space[]>([]);\r\n  const [selectedSpace, setSelectedSpace] = useState<Space | null>(null);\r\n  const [bookings, setBookings] = useState<Booking[]>([]);\r\n  const [myBookings, setMyBookings] = useState<Booking[]>([]);\r\n  const [openSpacesDialog, setOpenSpacesDialog] = useState(false);\r\n  const [openBookingDialog, setOpenBookingDialog] = useState(false);\r\n  const [startTime, setStartTime] = useState('00:00');\r\n  const [duration, setDuration] = useState(1);\r\n  const [description, setDescription] = useState('');\r\n  const [error, setError] = useState<string>('');\r\n  const [activeTab, setActiveTab] = useState(0);\r\n\r\n  useEffect(() => {\r\n    fetchSpaces();\r\n    fetchMyBookings();\r\n  }, []);\r\n\r\n  const fetchSpaces = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/api/spaces/`, {\r\n        headers: {\r\n          'Authorization': `Token ${token}`\r\n        }\r\n      });\r\n      setSpaces(response.data);\r\n    } catch (err) {\r\n      console.error('Error fetching spaces:', err);\r\n      setError('Ошибка при загрузке пространств');\r\n    }\r\n  };\r\n\r\n  const fetchMyBookings = async () => {\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/api/bookings/my/`, {\r\n        headers: {\r\n          'Authorization': `Token ${token}`\r\n        }\r\n      });\r\n      console.log('My bookings response:', response.data);\r\n      setMyBookings(response.data);\r\n    } catch (err) {\r\n      console.error('Error fetching my bookings:', err);\r\n      setError('Ошибка при загрузке ваших броней');\r\n    }\r\n  };\r\n\r\n  const getSpaceById = (spaceId: number): Space | undefined => {\r\n    return spaces.find(space => space.id === spaceId);\r\n  };\r\n\r\n  const calculateEndTime = (startTime: string, duration: number): string => {\r\n    return format(addHours(parseISO(startTime), duration / 60), \"yyyy-MM-dd'T'HH:mm:ssXXX\");\r\n  };\r\n\r\n  const handleDeleteBooking = async (bookingId: number) => {\r\n    try {\r\n      await axios.delete(`${API_BASE_URL}/api/bookings/${bookingId}/`, {\r\n        headers: {\r\n          'Authorization': `Token ${token}`\r\n        }\r\n      });\r\n      setMyBookings(myBookings.filter(booking => booking.id !== bookingId));\r\n      if (selectedSpace) {\r\n        const dateStr = format(selectedDate!, 'yyyy-MM-dd');\r\n        const response = await axios.get(`${API_BASE_URL}/api/spaces/${selectedSpace.id}/bookings/?date=${dateStr}`, {\r\n          headers: {\r\n            'Authorization': `Token ${token}`\r\n          }\r\n        });\r\n        setBookings(response.data);\r\n      }\r\n    } catch (err) {\r\n      console.error('Error deleting booking:', err);\r\n      setError('Ошибка при удалении брони');\r\n    }\r\n  };\r\n\r\n  const handleDateSelect = async (date: Date | null) => {\r\n    if (!date) return;\r\n    setSelectedDate(date);\r\n    setOpenSpacesDialog(true);\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/api/spaces/`, {\r\n        headers: {\r\n          'Authorization': `Token ${token}`\r\n        }\r\n      });\r\n      setSpaces(response.data);\r\n    } catch (err) {\r\n      console.error('Error fetching spaces:', err);\r\n      setError('Ошибка при загрузке пространств');\r\n    }\r\n  };\r\n\r\n  const handleSpaceSelect = async (space: Space) => {\r\n    setSelectedSpace(space);\r\n    setOpenSpacesDialog(false);\r\n    setOpenBookingDialog(true);\r\n    try {\r\n      const dateStr = format(selectedDate!, 'yyyy-MM-dd');\r\n      const response = await axios.get(`${API_BASE_URL}/api/spaces/${space.id}/bookings/?date=${dateStr}`, {\r\n        headers: {\r\n          'Authorization': `Token ${token}`\r\n        }\r\n      });\r\n      setBookings(response.data);\r\n    } catch (err) {\r\n      console.error('Error fetching bookings:', err);\r\n      setError('Ошибка при загрузке броней');\r\n    }\r\n  };\r\n\r\n  const handleCreateBooking = async () => {\r\n    if (!selectedSpace || !selectedDate) return;\r\n\r\n    try {\r\n      const startDateTime = parseISO(`${format(selectedDate, 'yyyy-MM-dd')}T${startTime}`);\r\n      const durationMinutes = duration * 60;\r\n\r\n      if (startDateTime < new Date()) {\r\n        setError('Нельзя создать бронь в прошлом');\r\n        return;\r\n      }\r\n\r\n      const response = await axios.post(`${API_BASE_URL}/api/bookings/`, {\r\n        space: selectedSpace.id,\r\n        start_time: format(startDateTime, \"yyyy-MM-dd'T'HH:mm:ssXXX\"),\r\n        duration: durationMinutes,\r\n        description: description || '-'\r\n      }, {\r\n        headers: {\r\n          'Authorization': `Token ${token}`,\r\n          'Content-Type': 'application/json'\r\n        }\r\n      });\r\n\r\n      setBookings([...bookings, response.data]);\r\n      setMyBookings([...myBookings, response.data]);\r\n      setOpenBookingDialog(false);\r\n      setError('');\r\n      setDescription('');\r\n    } catch (err) {\r\n      console.error('Error creating booking:', err);\r\n      if (axios.isAxiosError(err) && err.response?.data?.non_field_errors) {\r\n        setError(err.response.data.non_field_errors[0]);\r\n      } else {\r\n        setError('Ошибка при создании брони');\r\n      }\r\n    }\r\n  };\r\n\r\n  const getImageUrl = (imageUrl: string) => {\r\n    if (!imageUrl) return '';\r\n    if (imageUrl.startsWith('http')) return imageUrl;\r\n    return `${API_BASE_URL}${imageUrl}`;\r\n  };\r\n\r\n  const isMyBooking = (booking: Booking) => {\r\n    return myBookings.some(myBooking => myBooking.id === booking.id);\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ minHeight: '100vh', width: '100%', p: { xs: 1, sm: 2, md: 3 }, bgcolor: 'background.default' }}>\r\n      <Paper elevation={3} sx={{ p: { xs: 2, sm: 3, md: 4 }, height: '100%', display: 'flex', flexDirection: 'column' }}>\r\n        <Typography variant=\"h4\" gutterBottom sx={{ textAlign: 'center', mb: 3, color: 'primary.main' }}>\r\n          Календарь бронирований\r\n        </Typography>\r\n\r\n        <Tabs value={activeTab} onChange={(_, newValue) => setActiveTab(newValue)} sx={{ mb: 3 }}>\r\n          <Tab label=\"Календарь\" />\r\n          <Tab label=\"Мои брони\" />\r\n        </Tabs>\r\n\r\n        {activeTab === 0 ? (\r\n          <LocalizationProvider dateAdapter={AdapterDateFns} adapterLocale={ru}>\r\n            <Box sx={{ display: 'flex', justifyContent: 'center', mb: 3 }}>\r\n              <DateCalendar\r\n                value={selectedDate}\r\n                onChange={handleDateSelect}\r\n                sx={{ \r\n                  width: '100%',\r\n                  maxWidth: isMobile ? '100%' : 600,\r\n                  '& .MuiPickersCalendarHeader-root': {\r\n                    display: 'flex',\r\n                    alignItems: 'center',\r\n                    justifyContent: 'space-between',\r\n                    px: 2\r\n                  },\r\n                  '& .MuiPickersDay-root': {\r\n                    width: isMobile ? 36 : 48,\r\n                    height: isMobile ? 36 : 48,\r\n                    fontSize: isMobile ? '0.875rem' : '1rem'\r\n                  }\r\n                }}\r\n              />\r\n            </Box>\r\n          </LocalizationProvider>\r\n        ) : (\r\n          <Box>\r\n            <Typography variant=\"h6\" gutterBottom>Мои брони:</Typography>\r\n            {myBookings.length === 0 ? (\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                У вас пока нет броней\r\n              </Typography>\r\n            ) : (\r\n              <Grid container spacing={2}>\r\n                {myBookings.map((booking) => {\r\n                  const space = getSpaceById(booking.space);\r\n                  const endTime = calculateEndTime(booking.start_time, booking.duration);\r\n                  return (\r\n                    <Grid item xs={12} sm={6} md={4} key={booking.id}>\r\n                      <Card>\r\n                        <CardContent>\r\n                          <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start' }}>\r\n                            <Box>\r\n                              <Typography variant=\"h6\" gutterBottom>\r\n                                {space?.name || 'Загрузка...'}\r\n                              </Typography>\r\n                              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                {format(parseISO(booking.start_time), 'dd.MM.yyyy HH:mm')} - \r\n                                {format(parseISO(endTime), 'HH:mm')}\r\n                              </Typography>\r\n                              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                {booking.description}\r\n                              </Typography>\r\n                            </Box>\r\n                            <IconButton \r\n                              onClick={() => handleDeleteBooking(booking.id)}\r\n                              color=\"error\"\r\n                              size=\"small\"\r\n                            >\r\n                              <DeleteIcon />\r\n                            </IconButton>\r\n                          </Box>\r\n                        </CardContent>\r\n                      </Card>\r\n                    </Grid>\r\n                  );\r\n                })}\r\n              </Grid>\r\n            )}\r\n          </Box>\r\n        )}\r\n      </Paper>\r\n\r\n      <Dialog open={openSpacesDialog} onClose={() => setOpenSpacesDialog(false)} maxWidth=\"md\" fullWidth fullScreen={isMobile}>\r\n        <DialogTitle sx={{ textAlign: 'center' }}>Выберите пространство</DialogTitle>\r\n        <DialogContent>\r\n          <Grid container spacing={2}>\r\n            {spaces.map((space) => (\r\n              <Grid item xs={12} sm={6} md={4} key={space.id}>\r\n                <Card \r\n                  sx={{ \r\n                    cursor: 'pointer',\r\n                    height: '100%',\r\n                    display: 'flex',\r\n                    flexDirection: 'column',\r\n                    '&:hover': { \r\n                      boxShadow: 6,\r\n                      transform: 'translateY(-4px)',\r\n                      transition: 'all 0.3s ease-in-out'\r\n                    }\r\n                  }}\r\n                  onClick={() => handleSpaceSelect(space)}\r\n                >\r\n                  {space.image && (\r\n                    <CardMedia\r\n                      component=\"img\"\r\n                      height={isMobile ? 160 : 200}\r\n                      image={getImageUrl(space.image)}\r\n                      alt={space.name}\r\n                      sx={{ objectFit: 'cover' }}\r\n                    />\r\n                  )}\r\n                  <CardContent sx={{ flexGrow: 1 }}>\r\n                    <Typography variant=\"h6\" gutterBottom>\r\n                      {space.name}\r\n                    </Typography>\r\n                    <Typography variant=\"body2\" color=\"text.secondary\">\r\n                      {space.description}\r\n                    </Typography>\r\n                  </CardContent>\r\n                </Card>\r\n              </Grid>\r\n            ))}\r\n          </Grid>\r\n        </DialogContent>\r\n      </Dialog>\r\n\r\n      <Dialog open={openBookingDialog} onClose={() => setOpenBookingDialog(false)} maxWidth=\"md\" fullWidth fullScreen={isMobile}>\r\n        <DialogTitle sx={{ textAlign: 'center' }}>\r\n          Бронирование {selectedSpace?.name} на {selectedDate && format(selectedDate, 'dd.MM.yyyy')}\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          {error && <Alert severity=\"error\" sx={{ mb: 2 }}>{error}</Alert>}\r\n          \r\n          <Box sx={{ mb: 3 }}>\r\n            <Typography variant=\"h6\" gutterBottom>Занятое время:</Typography>\r\n            {bookings.length === 0 ? (\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                На этот день нет броней\r\n              </Typography>\r\n            ) : (\r\n              <Grid container spacing={1}>\r\n                {bookings.map((booking) => {\r\n                  const startTime = format(parseISO(booking.start_time), 'HH:mm');\r\n                  const endTime = format(parseISO(calculateEndTime(booking.start_time, booking.duration)), 'HH:mm');\r\n                  const isMyBookingItem = isMyBooking(booking);\r\n                  return (\r\n                    <Grid item xs={12} sm={6} md={4} key={booking.id}>\r\n                      <Paper \r\n                        elevation={2}\r\n                        sx={{ \r\n                          p: 1.5,\r\n                          bgcolor: isMyBookingItem ? 'primary.light' : 'error.light',\r\n                          color: isMyBookingItem ? 'primary.contrastText' : 'error.contrastText',\r\n                          textAlign: 'center',\r\n                          borderRadius: 1,\r\n                          position: 'relative',\r\n                          cursor: isMyBookingItem ? 'pointer' : 'default',\r\n                          '&:hover': isMyBookingItem ? {\r\n                            bgcolor: 'primary.main',\r\n                          } : {}\r\n                        }}\r\n                        onClick={() => isMyBookingItem && handleDeleteBooking(booking.id)}\r\n                      >\r\n                        <Typography variant=\"body2\" fontWeight=\"medium\">\r\n                          {startTime} - {endTime}\r\n                        </Typography>\r\n                        {isMyBookingItem && (\r\n                          <Tooltip title=\"Нажмите, чтобы удалить\">\r\n                            <DeleteIcon sx={{ \r\n                              position: 'absolute', \r\n                              top: 4, \r\n                              right: 4, \r\n                              fontSize: 16 \r\n                            }} />\r\n                          </Tooltip>\r\n                        )}\r\n                      </Paper>\r\n                    </Grid>\r\n                  );\r\n                })}\r\n              </Grid>\r\n            )}\r\n          </Box>\r\n\r\n          <Box sx={{ \r\n            display: 'flex', \r\n            flexDirection: isMobile ? 'column' : 'row',\r\n            gap: 2, \r\n            mb: 2 \r\n          }}>\r\n            <TextField\r\n              label=\"Время начала\"\r\n              type=\"time\"\r\n              value={startTime}\r\n              onChange={(e) => setStartTime(e.target.value)}\r\n              InputLabelProps={{ shrink: true }}\r\n              inputProps={{ step: 300 }}\r\n              sx={{ width: isMobile ? '100%' : '50%' }}\r\n            />\r\n            <TextField\r\n              label=\"Длительность (часы)\"\r\n              type=\"number\"\r\n              value={duration}\r\n              onChange={(e) => setDuration(Number(e.target.value))}\r\n              InputProps={{ inputProps: { min: 1, max: 24 } }}\r\n              sx={{ width: isMobile ? '100%' : '50%' }}\r\n            />\r\n          </Box>\r\n\r\n          <TextField\r\n            label=\"Описание (необязательно)\"\r\n            value={description}\r\n            onChange={(e) => setDescription(e.target.value)}\r\n            multiline\r\n            rows={2}\r\n            fullWidth\r\n            sx={{ mb: 2 }}\r\n          />\r\n\r\n          <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n            Время окончания: {selectedDate && startTime && \r\n              format(addHours(parseISO(`${format(selectedDate, 'yyyy-MM-dd')}T${startTime}`), duration), 'HH:mm')}\r\n          </Typography>\r\n        </DialogContent>\r\n        <DialogActions sx={{ p: 2 }}>\r\n          <Button \r\n            onClick={() => setOpenBookingDialog(false)}\r\n            variant=\"outlined\"\r\n            fullWidth={isMobile}\r\n          >\r\n            Отмена\r\n          </Button>\r\n          <Button \r\n            onClick={handleCreateBooking} \r\n            variant=\"contained\" \r\n            color=\"primary\"\r\n            fullWidth={isMobile}\r\n          >\r\n            Забронировать\r\n          </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Calendar; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}